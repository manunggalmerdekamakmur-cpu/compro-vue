<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PT. Manunggal Merdeka Makmur â€“ Produsen Pupuk Organik Berkualitas</title>
  <meta name="description" content="PT. Manunggal Merdeka Makmur adalah produsen pupuk organik dan agen hayati berkualitas tinggi untuk pertanian berkelanjutan.">
  <meta name="theme-color" content="#0b1f14">
  <meta name="robots" content="index, follow">

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="version" content="1.0.5"> 

  <link rel="preconnect" href="https://res.cloudinary.com">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dz1zcobkz/image/upload/v1768461077/favicon_cqc5pw.ico">
  <link rel="prefetch" as="image" href="https://res.cloudinary.com/dz1zcobkz/image/upload/v1768807981/visi-misi-bg_w1tk8e_drwylj.webp" type="image/webp" fetchpriority="high">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />
</head>

<body class="loading">
  <div id="app"></div>

  <div id="app-loading">
    <div class="css-spinner"></div>
    <div class="loading-text">Memuat aplikasi...</div>
  </div>

  <script>
    (function() {
      const VERSION = '1.0.5';
      const TIMESTAMP = Date.now();
      const BUILD_ID = `${VERSION}-${TIMESTAMP}`;
      
      console.log('ðŸ”¥ EXTREME CACHE BUSTING - Version:', VERSION, 'Build ID:', BUILD_ID);
      
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then(registrations => {
          for (const registration of registrations) {
            registration.unregister();
          }
        });
      }
      
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          cacheNames.forEach(cacheName => caches.delete(cacheName));
        });
      }
      
      localStorage.clear();
      sessionStorage.clear();
      
      if (window.indexedDB && indexedDB.databases) {
        indexedDB.databases().then(dbs => {
          dbs.forEach(db => {
            if (db.name) indexedDB.deleteDatabase(db.name);
          });
        });
      }
      
      localStorage.setItem('app_version', VERSION);
      localStorage.setItem('build_id', BUILD_ID);
      localStorage.setItem('last_deploy', TIMESTAMP);
      
      const url = new URL(window.location.href);
      const params = new URLSearchParams(url.search);
      
      params.delete('v');
      params.delete('t');
      params.delete('cb');
      
      params.set('v', VERSION);
      params.set('t', TIMESTAMP);
      params.set('cb', BUILD_ID);
      params.set('_', Date.now()); 
      
      url.search = params.toString();
      
      if (!sessionStorage.getItem('cache_bust_redirect')) {
        sessionStorage.setItem('cache_bust_redirect', 'true');
        console.log('ðŸ”„ FORCE REDIRECTING TO:', url.toString());
        window.location.replace(url.toString());
        return; 
      }
      
      const rewriteResources = () => {
        const cacheBust = `?v=${VERSION}&t=${TIMESTAMP}&cb=${BUILD_ID}&_=${Date.now()}`;
        
        document.querySelectorAll('script[src]').forEach(script => {
          const src = script.getAttribute('src');
          if (src && src.includes('/src/')) {
            const newSrc = src + cacheBust;
            script.src = newSrc;
          }
        });
      };
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', rewriteResources);
      } else {
        rewriteResources();
      }
      
      setInterval(() => {
        fetch('/?ping=' + Date.now(), {
          method: 'HEAD',
          cache: 'no-store',
          headers: {
            'Pragma': 'no-cache',
            'Cache-Control': 'no-cache'
          }
        }).then(() => {
          const storedVersion = localStorage.getItem('app_version');
          if (storedVersion !== VERSION) {
            console.log('ðŸ”„ UPDATE DETECTED, RELOADING...');
            window.location.reload();
          }
        }).catch(() => {
        });
      }, 120000);
    })();
  </script>

  <script type="module" src="/src/main.js"></script>

  <script>
    if (!window.location.search.includes('cb=')) {
      const lcpObserver = new PerformanceObserver((entryList) => {
        const entries = entryList.getEntries();
        const lastEntry = entries[entries.length - 1];
        console.log('LCP:', lastEntry.startTime);
      });
      lcpObserver.observe({ type: 'largest-contentful-paint', buffered: true });

      const clsObserver = new PerformanceObserver((entryList) => {
        for (const entry of entryList.getEntries()) {
          if (!entry.hadRecentInput) {
            console.log('CLS:', entry.value);
          }
        }
      });
      clsObserver.observe({ type: 'layout-shift', buffered: true });
    }
  </script>
</body>
</html>